var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},Ship=function(n){function t(i){n.call(this),this.MovementController=new ShipMovementController(Vector2.Zero()),this.UpdateProperties(i),this.WIDTH=t.WIDTH,this.HEIGHT=t.HEIGHT,this._maxWidth=this.WIDTH*.8,this._xOffset=(this.WIDTH-this._maxWidth)*.5,this.AnimationHandler=new ShipAnimationHandler(this),this.ShipAbilityHandler=new ShipAbilityHandler(this)}return __extends(t,n),t.prototype.Destroy=function(){this.LifeController.Alive||GAME_GLOBALS.AnimationManager.Add(new spritify({image:IMAGE_ASSETS.BigExplosion,centerOn:{X:this.MovementController.Position.X+t.HALF_WIDTH,Y:this.MovementController.Position.Y+t.HALF_HEIGHT},frameCount:30,fps:25,spriteSheetSize:new Size(768,640),frameSize:new Size(128,128),Rotation:this.MovementController.Rotation})),this.Visible=!1},t.prototype.Update=function(){var n=CalculatePOS(this.LastUpdated);this.UpdateFromSecond(n)},t.prototype.UpdateFromSecond=function(n){var t=new Date;this.MovementController.Update(n,t),this.AnimationHandler.Update(t),this.AnimationHandler.DrawDamage(),this.ShipAbilityHandler.Update(t),this.LastUpdated=t},t.prototype.DrawHealthBar=function(){this._lastHealth!==this.LifeController.Health&&(this._currentHealthPercentage=this.LifeController.Health/this.MaxLife,this._currentHealth=this._maxWidth*this._currentHealthPercentage,this._lastHealth=this.LifeController.Health,this._miniHealthBarColor=this._currentHealthPercentage<=HealthMonitor.BadThreshold?GAME_GLOBALS.Colors.ShipBad:this._currentHealthPercentage<=HealthMonitor.HurtThreshold?GAME_GLOBALS.Colors.ShipHurt:GAME_GLOBALS.Colors.ShipGood),CanvasContext.drawRectangle(this.MovementController.Position.X+this._xOffset,this.MovementController.Position.Y+this.HEIGHT+15,this._maxWidth,5,"#7F767D"),CanvasContext.drawRectangle(this.MovementController.Position.X+this._xOffset,this.MovementController.Position.Y+this.HEIGHT+15,this._currentHealth,5,this._miniHealthBarColor)},t.prototype.DrawName=function(n){CanvasContext.drawText(this.Name,this.MovementController.Position.X+t.HALF_WIDTH,this.MovementController.Position.Y+this.HEIGHT+30+n)},t}(Collidable)